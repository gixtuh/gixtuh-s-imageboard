<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>gixtuh's imageboard (BETA)</title>
<style>
  body { 
    font-family: sans-serif; 
    padding: 20px; 
  }
  .thread { 
    border: 1px solid #ccc; 
    margin: 10px 0; 
    padding: 10px; 
  }
  img { 
    max-width: 200px; 
    display: block; 
    margin-top: 5px; 
  
    /* blur effect */
    filter: blur(20px); 
    transition: filter 0.3s ease;
    cursor: pointer;
  }
  img:active { 
    filter: blur(0); 
  }
</style>
  
</head>
<body>
<h1>gixtuh's imageboard</h1>

<h2>make board</h2>
<form id="createThread" enctype="multipart/form-data">
  title: <input name="title"><br>
  content: <input name="content"><br>
  image: <input type="file" name="image"><br>
  <button>make</button>
</form>

<h2>boards</h2>
<div id="threads"></div>

<script>
async function loadThreads() {
  const res = await fetch('/threads');
  const threads = await res.json();
  const container = document.getElementById('threads');
  container.innerHTML = '';
  threads.reverse().forEach(t => {
    const div = document.createElement('div');
    div.className = 'thread';
    div.innerHTML = `
      <strong>${t.title}</strong><br>
      ${t.content}<br>
      ${t.image ? `<img src="${t.image}">` : ''}<br>
      <a href="thread.html?id=${t.id}">View & Reply</a><br>
      created at: ${t.createdAt}<br>
      id: ${t.id}
    `;
    container.appendChild(div);
  });
}

document.getElementById('createThread').addEventListener('submit', async (e) => {
  e.preventDefault();
  const form = e.target;
  const data = new FormData(form);
  await fetch('/thread', { method: 'POST', body: data });
  form.reset();
  loadThreads();
});

loadThreads();
</script>
</body>
</html>
